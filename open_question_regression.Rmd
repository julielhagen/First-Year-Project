---
title: "FYP2_open_question"
author: "Sander Engel Thilo"
date: "2023-05-15"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Open Question

For the open question for the skin lesion image processing project, we decided to explore the features of the lesions using binomial logistic regression. To do this, we looked at data points in the meta data which concerns the actual lesions (and not the patient themselves) as predictor variables, those being "diameter_1", "diameter_2", "itch", "grew", "hurt", "changed", "bleed", and "elevation", to see whether they can accurately predict the diagnosis. 

```{r}
# Read data
data <- read.csv("metadata.csv")
```

### Data preperation

```{r}
lesion_info_cols <- c("diameter_1", "diameter_2", "itch", "grew", "hurt", "changed", "bleed", "elevation", "diagnostic")
lesion_info <- subset(data, select = lesion_info_cols)
lesion_info[lesion_info == "True"] <- 1
lesion_info[lesion_info == "False"] <- 0
lesion_info[lesion_info == "UNK"] <- NA

# Diagnosis mapping

# Non-cancer diagnoses
lesion_info[lesion_info == "ACK"] = 0
lesion_info[lesion_info == "NEV"] = 0
lesion_info[lesion_info == "SEK"] = 0

# Cancer diagnoses
lesion_info[lesion_info == "BCC"] = 1
lesion_info[lesion_info == "MEL"] = 1
lesion_info[lesion_info == "SCC"] = 1
```

### Handling missing data

```{r}
library(Amelia)
missmap(lesion_info, main = "Missing values vs observed")
```
Since the predictor variables "diameter_2", "diameter_1", "grew" and "changes" are missing a substantial amount of data point, we are removing these from the model. "hurt" and "bleed" each have two missing values, but since this is such a small amount, we will instead remove the corresponding observations to get a complete dataset.

```{r}
prepped_data <- subset(lesion_info, select = -c(diameter_1, diameter_2, grew, changed))
prepped_data <- na.omit(prepped_data)

prepped_data$diagnostic <- as.numeric(prepped_data$diagnostic)
prepped_data$itch <- as.numeric(prepped_data$itch)
prepped_data$hurt <- as.numeric(prepped_data$hurt)
prepped_data$bleed <- as.numeric(prepped_data$bleed)
prepped_data$elevation <- as.numeric(prepped_data$elevation)
```

### Model fitting

To fit the logistic regression model, we will be splitting the dataset into training and test sets.

```{r}
train <- prepped_data[1:1600,]
test <- prepped_data[1601:nrow(prepped_data),]
```


We will now fit the model using glm() function.

```{r}
model <- glm(diagnostic ~ ., family = binomial(link = 'logit'), data = train)
summary(model)
```

### Model Interpretation

Looking at the coefficients, we can conclude that all predictor variables are statistically significant with p-values below 0.001. Furthermore, as "bleed" and "elevation" have the lowest p-values, these have the strongest association with the probability of 




